module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},43619,a=>{a.n(a.i(79962))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},70844,a=>{a.n(a.i(92359))},31290,96818,18956,99602,10236,a=>{"use strict";let b=Symbol.for("constructDateFrom");function c(a,c){return"function"==typeof a?a(c):a&&"object"==typeof a&&b in a?a[b](c):a instanceof Date?new a.constructor(c):new Date(c)}function d(a,b){return c(b||a,a)}function e(a,b,e){let f=d(a,e?.in);return isNaN(b)?c(e?.in||a,NaN):(b&&f.setDate(f.getDate()+b),f)}function f(a,b,c){return e(a,-b,c)}a.s(["constructFromSymbol",0,b,"millisecondsInDay",0,864e5,"millisecondsInMinute",0,6e4,"millisecondsInWeek",0,6048e5],96818),a.s(["constructFrom",()=>c],18956),a.s(["toDate",()=>d],99602),a.s(["addDays",()=>e],10236),a.s(["subDays",()=>f],31290)},35330,84347,14962,a=>{"use strict";var b=a.i(7997);let c=function(){for(var a,b,c=0,d="",e=arguments.length;c<e;c++)(a=arguments[c])&&(b=function a(b){var c,d,e="";if("string"==typeof b||"number"==typeof b)e+=b;else if("object"==typeof b)if(Array.isArray(b)){var f=b.length;for(c=0;c<f;c++)b[c]&&(d=a(b[c]))&&(e&&(e+=" "),e+=d)}else for(d in b)b[d]&&(e&&(e+=" "),e+=d);return e}(a))&&(d&&(d+=" "),d+=b);return d};function d({title:a,description:d,className:e,children:f,actions:g}){return(0,b.jsxs)("section",{className:c("card p-6 space-y-4",e),children:[(a||d||g)&&(0,b.jsxs)("header",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[a?(0,b.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:a}):null,d?(0,b.jsx)("p",{className:"text-sm text-slate-500",children:d}):null]}),g]}),(0,b.jsx)("div",{children:f})]})}function e({eyebrow:a,title:d,description:e,actions:f,children:g,className:h}){return(0,b.jsxs)("section",{className:c("relative overflow-hidden rounded-[32px] border border-white/60 bg-white/80 p-6 shadow-[0px_25px_60px_rgba(15,23,42,0.08)] backdrop-blur",h),children:[(0,b.jsxs)("div",{className:"pointer-events-none absolute inset-0",children:[(0,b.jsx)("div",{className:"absolute -top-16 -right-8 h-48 w-48 rounded-full bg-brand/15 blur-3xl"}),(0,b.jsx)("div",{className:"absolute bottom-[-60px] left-[-40px] h-44 w-44 rounded-full bg-accent/10 blur-3xl"})]}),(0,b.jsxs)("div",{className:"relative z-10 flex flex-wrap items-start gap-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[a?(0,b.jsx)("span",{className:"inline-flex items-center rounded-full border border-slate-100/70 bg-slate-50/80 px-3 py-1 text-xs font-semibold uppercase tracking-[0.16em] text-slate-500",children:a}):null,(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-semibold leading-tight text-slate-900",children:d}),e?(0,b.jsx)("p",{className:"mt-2 max-w-3xl text-sm text-slate-600",children:e}):null]})]}),f?(0,b.jsx)("div",{className:"ml-auto flex flex-col items-stretch gap-3",children:f}):null]}),g?(0,b.jsx)("div",{className:"relative z-10 mt-6",children:g}):null]})}function f({items:a,columns:d=3}){return(0,b.jsx)("div",{className:c("grid gap-4 text-sm text-slate-600",2===d?"sm:grid-cols-2":4===d?"sm:grid-cols-2 lg:grid-cols-4":"sm:grid-cols-3"),children:a.map(a=>(0,b.jsxs)("div",{className:"rounded-2xl border border-slate-100/70 bg-white/90 px-4 py-3 shadow-inner shadow-slate-200/70",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:a.label}),(0,b.jsx)("p",{className:"mt-1 text-base font-semibold text-slate-900",children:a.value}),a.helper?(0,b.jsx)("p",{className:"mt-0.5 text-xs text-slate-500",children:a.helper}):null]},`${a.label}-${a.value}`))})}a.s(["default",0,c],84347),a.s(["Card",()=>d],35330),a.s(["PageHeader",()=>e,"PageHeaderMeta",()=>f],14962)},43116,a=>{"use strict";function b(a,c="USD",d=0){return new Intl.NumberFormat("en-US",{style:"currency",currency:c,maximumFractionDigits:d}).format(a)}function c(a,b=0){return new Intl.NumberFormat("en-US",{maximumFractionDigits:b}).format(a)}function d(a,b=1){return new Intl.NumberFormat("en-US",{style:"percent",maximumFractionDigits:b}).format(a)}function e(a,b={month:"short",day:"numeric",year:"numeric"}){let c="string"==typeof a?new Date(a):a;return new Intl.DateTimeFormat("en-US",b).format(c)}a.s(["formatCurrency",()=>b,"formatDate",()=>e,"formatNumber",()=>c,"formatPercent",()=>d])},48461,a=>{"use strict";var b=a.i(99602);function c(a,c){let d=(0,b.toDate)(a,c?.in);return d.setHours(0,0,0,0),d}a.s(["startOfDay",()=>c])},45310,a=>{"use strict";var b=a.i(7997),c=a.i(84347);function d({children:a,className:d}){return(0,b.jsx)("table",{className:(0,c.default)("min-w-full divide-y divide-slate-200",d),children:a})}function e({children:a}){return(0,b.jsx)("thead",{className:"bg-slate-50",children:(0,b.jsx)("tr",{className:"text-xs font-semibold uppercase tracking-wider text-slate-500",children:a})})}function f({children:a}){return(0,b.jsx)("tbody",{className:"divide-y divide-slate-100 bg-white text-sm text-slate-700",children:a})}function g({children:a,align:d="left",className:e}){return(0,b.jsx)("th",{scope:"col",className:(0,c.default)("px-4 py-3",{"text-left":"left"===d,"text-center":"center"===d,"text-right":"right"===d},e),children:a})}function h({children:a,align:d="left",className:e}){return(0,b.jsx)("td",{className:(0,c.default)("px-4 py-3",{"text-left":"left"===d,"text-center":"center"===d,"text-right":"right"===d},e),children:a})}a.s(["TBody",()=>f,"TD",()=>h,"TH",()=>g,"THead",()=>e,"Table",()=>d])},19637,a=>{"use strict";var b=a.i(7997),c=a.i(84347);let d={default:"bg-slate-100 text-slate-800",success:"bg-green-100 text-green-800",warning:"bg-amber-100 text-amber-800",danger:"bg-red-100 text-red-700"};function e({children:a,variant:e="default",className:f}){return(0,b.jsx)("span",{className:(0,c.default)("inline-flex items-center rounded-full px-3 py-0.5 text-xs font-medium",d[e],f),children:a})}a.s(["Badge",()=>e])},95805,a=>{"use strict";var b=a.i(99602);function c(a,c){let d=(0,b.toDate)(a,c?.in);return d.setDate(1),d.setHours(0,0,0,0),d}a.s(["startOfMonth",()=>c])},7950,a=>{"use strict";var b=a.i(18956),c=a.i(99602);function d(a,d,e){return function(a,d,e){let f=(0,c.toDate)(a,e?.in);if(isNaN(d))return(0,b.constructFrom)(e?.in||a,NaN);if(!d)return f;let g=f.getDate(),h=(0,b.constructFrom)(e?.in||a,f.getTime());return(h.setMonth(f.getMonth()+d+1,0),g>=h.getDate())?h:(f.setFullYear(h.getFullYear(),h.getMonth(),g),f)}(a,-d,e)}a.s(["subMonths",()=>d],7950)},65314,a=>{"use strict";var b=a.i(12208),c=a.i(95805),d=a.i(99602),e=a.i(7950);function f(a=12,g=new Date){let h=[],i=(0,c.startOfMonth)(g);for(let c=a-1;c>=0;c-=1){let a=(0,e.subMonths)(i,c);h.push({key:(0,b.format)(a,"yyyy-MM"),label:(0,b.format)(a,"MMM yy"),start:a,end:function(a,b){let c=(0,d.toDate)(a,void 0),e=c.getMonth();return c.setFullYear(c.getFullYear(),e+1,0),c.setHours(23,59,59,999),c}(a)})}return h}a.s(["getMonthlyBuckets",()=>f],65314)},92924,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call PieChartComponent() from the server but PieChartComponent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/charts/pie-chart.tsx <module evaluation>","PieChartComponent");a.s(["PieChartComponent",0,b])},30270,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call PieChartComponent() from the server but PieChartComponent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/charts/pie-chart.tsx","PieChartComponent");a.s(["PieChartComponent",0,b])},37069,a=>{"use strict";a.i(92924);var b=a.i(30270);a.n(b)},55703,a=>{"use strict";var b=a.i(95805),c=a.i(31290),d=a.i(7950),e=a.i(66518),f=a.i(65314);async function g(a){let{page:g,pageSize:h,query:i,minTotalGiven:j,lastGiftFrom:k,lastGiftTo:l}=a,m={},n=[{name:"< $1k",min:0,max:1e3},{name:"$1k - $5k",min:1e3,max:5e3},{name:"$5k - $10k",min:5e3,max:1e4},{name:"$10k+",min:1e4,max:1/0}],o=(0,f.getMonthlyBuckets)(12);i&&(m.OR=[{name:{contains:i,mode:"insensitive"}},{email:{contains:i,mode:"insensitive"}}]),j&&(m.totalGiven={gte:j}),(k||l)&&(m.lastGiftDate={},k&&(m.lastGiftDate.gte=k),l&&(m.lastGiftDate.lte=l));try{let a,[f,i,j,k,l,p,q]=await Promise.all([e.prisma.donor.count({where:m}),e.prisma.donor.findMany({where:m,orderBy:{totalGiven:"desc"},take:h,skip:(g-1)*h,select:{id:!0,name:!0,email:!0,phone:!0,totalGiven:!0,totalPledged:!0,lastGiftDate:!0}}),e.prisma.donor.count(),e.prisma.donor.count({where:{lastGiftDate:{gte:(0,c.subDays)(new Date,365)}}}),e.prisma.donor.aggregate({_avg:{totalGiven:!0}}),e.prisma.donor.findMany({where:{createdAt:{gte:(0,d.subMonths)((0,b.startOfMonth)(new Date),11)}},select:{createdAt:!0}}),e.prisma.donor.findMany({select:{totalGiven:!0}})]),r=i.map(a=>{let b,c;return{...a,totalGiven:(b=a.totalGiven,Number(b??0)),totalPledged:(c=a.totalPledged,Number(c??0))}}),s=o.map(a=>({label:a.label,value:p.filter(b=>b.createdAt>=a.start&&b.createdAt<=a.end).length})),t=n.map(a=>({name:a.name,value:q.filter(b=>{let c,d=(c=b.totalGiven,Number(c??0));return d>=a.min&&d<a.max}).length}));return{donors:r,pagination:{page:g,pageSize:h,total:f,totalPages:Math.max(1,Math.ceil(f/h))},summary:{totalDonors:j,activeDonors:k,averageLifetimeValue:(a=l._avg.totalGiven,Number(a??0))},charts:{acquisitions:s,giftDistribution:t}}}catch(a){return console.error("Failed to load donor list data. Serving fallback dataset.",a),function({page:a,pageSize:b,acquisitionBuckets:c,giftRanges:d}){return{donors:[],pagination:{page:a,pageSize:b,total:0,totalPages:1},summary:{totalDonors:0,activeDonors:0,averageLifetimeValue:0},charts:{acquisitions:c.map(a=>({label:a.label,value:0})),giftDistribution:d.map(a=>({name:a.name,value:0}))}}}({page:g,pageSize:h,acquisitionBuckets:o,giftRanges:n})}}a.s(["getDonorList",()=>g])},53817,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Pagination() from the server but Pagination is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/pagination.tsx <module evaluation>","Pagination");a.s(["Pagination",0,b])},45062,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call Pagination() from the server but Pagination is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/ui/pagination.tsx","Pagination");a.s(["Pagination",0,b])},73355,a=>{"use strict";a.i(53817);var b=a.i(45062);a.n(b)},74408,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call DonorFilters() from the server but DonorFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/(dashboard)/donors/_components/donor-filters.tsx <module evaluation>","DonorFilters");a.s(["DonorFilters",0,b])},17586,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call DonorFilters() from the server but DonorFilters is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/app/(dashboard)/donors/_components/donor-filters.tsx","DonorFilters");a.s(["DonorFilters",0,b])},71998,a=>{"use strict";a.i(74408);var b=a.i(17586);a.n(b)},82983,a=>{"use strict";var b=a.i(7997),c=a.i(35330),d=a.i(45310),e=a.i(19637),f=a.i(73355),g=a.i(37069),h=a.i(58388),i=a.i(71998),j=a.i(55703),k=a.i(43116),l=a.i(14962);async function m({searchParams:a}){let m=await Promise.resolve(a)??{},n=Math.max(1,Number(m.page??"1")),o=m.minTotalGiven?Number(m.minTotalGiven):void 0,p=m.lastGiftFrom?new Date(m.lastGiftFrom):void 0,q=m.lastGiftTo?new Date(m.lastGiftTo):void 0,r=await (0,j.getDonorList)({page:n,pageSize:10,query:m.query,minTotalGiven:o,lastGiftFrom:Number.isNaN(p?.getTime()??NaN)?void 0:p,lastGiftTo:Number.isNaN(q?.getTime()??NaN)?void 0:q});return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)(l.PageHeader,{eyebrow:"Supporters",title:"Donor intelligence",description:"Understand giving behavior and surface the right audience for outreach.",children:(0,b.jsx)(l.PageHeaderMeta,{items:[{label:"Total donors",value:(0,k.formatNumber)(r.summary.totalDonors)},{label:"Active donors (12m)",value:(0,k.formatNumber)(r.summary.activeDonors)},{label:"Avg lifetime value",value:(0,k.formatCurrency)(r.summary.averageLifetimeValue)}]})}),(0,b.jsx)(i.DonorFilters,{initialQuery:m.query,initialMinTotalGiven:o,initialLastGiftFrom:m.lastGiftFrom,initialLastGiftTo:m.lastGiftTo}),(0,b.jsxs)(c.Card,{title:"Donor roster",description:"Sortable list of BHIC supporters with pledge + gift metrics",children:[(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(d.Table,{children:[(0,b.jsxs)(d.THead,{children:[(0,b.jsx)(d.TH,{children:"Name"}),(0,b.jsx)(d.TH,{children:"Email"}),(0,b.jsx)(d.TH,{children:"Total pledged"}),(0,b.jsx)(d.TH,{children:"Total given"}),(0,b.jsx)(d.TH,{children:"Last gift"}),(0,b.jsx)(d.TH,{children:"Status"})]}),(0,b.jsx)(d.TBody,{children:r.donors.map(a=>(0,b.jsxs)("tr",{children:[(0,b.jsxs)(d.TD,{children:[(0,b.jsx)("p",{className:"font-semibold text-slate-900",children:a.name}),a.phone?(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.phone}):null]}),(0,b.jsx)(d.TD,{children:a.email??"N/A"}),(0,b.jsx)(d.TD,{children:(0,k.formatCurrency)(a.totalPledged)}),(0,b.jsx)(d.TD,{children:(0,k.formatCurrency)(a.totalGiven)}),(0,b.jsx)(d.TD,{children:a.lastGiftDate?(0,k.formatDate)(a.lastGiftDate):"No gifts yet"}),(0,b.jsx)(d.TD,{children:(0,b.jsx)(e.Badge,{variant:a.lastGiftDate?"success":"default",children:a.lastGiftDate?"Active":"Prospect"})})]},a.id))})]})}),(0,b.jsx)(f.Pagination,{page:r.pagination.page,totalPages:r.pagination.totalPages})]}),(0,b.jsxs)("section",{className:"grid gap-4 lg:grid-cols-2",children:[(0,b.jsx)(c.Card,{title:"Donors acquired",description:"Monthly count of new supporters",children:(0,b.jsx)(h.TimeSeriesChart,{data:r.charts.acquisitions,lines:[{dataKey:"value",color:"#2563eb",name:"Donors"}]})}),(0,b.jsx)(c.Card,{title:"Gift size distribution",description:"Lifetime value buckets",children:(0,b.jsx)(g.PieChartComponent,{data:r.charts.giftDistribution.map(a=>({name:a.name,value:a.value}))})})]})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__7d4c8039._.js.map