(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,93479,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(7670);let n=(0,a.forwardRef)(function({className:e,error:a,...n},l){return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("input",{ref:l,className:(0,s.default)("w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 outline-none transition focus:border-brand focus:ring-2 focus:ring-brand/30",e),...n}),a?(0,t.jsx)("p",{className:"text-xs text-red-500",children:a}):null]})});e.s(["Input",0,n])},19608,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(19455),n=e.i(93479),l=e.i(7670);let i=(0,a.forwardRef)(function({className:e,children:a,error:s,...n},i){return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("select",{ref:i,className:(0,l.default)("w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 outline-none transition focus:border-brand focus:ring-2 focus:ring-brand/30",e),...n,children:a}),s?(0,t.jsx)("p",{className:"text-xs text-red-500",children:s}):null]})}),d=(0,a.forwardRef)(function({className:e,error:a,...s},n){return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("textarea",{ref:n,className:(0,l.default)("w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 outline-none transition focus:border-brand focus:ring-2 focus:ring-brand/30",e),...s}),a?(0,t.jsx)("p",{className:"text-xs text-red-500",children:a}):null]})});function r({data:e,action:l}){var r;let m,[c,o]=(0,a.useState)(0),[x,u]=(0,a.useTransition)(),[p,h]=(0,a.useState)({}),[g,j]=(0,a.useState)({name:"",audience:{donatedWithinDays:90,totalGivenGreaterThan:1e3,attendedEventIds:[],pledgeCampaigns:[]},templateMode:e.templates.length?"existing":"new",templateId:e.templates[0]?.id??"",newTemplate:{name:"",subject:"",html:"<p>Dear {{ name }},<br/>Thank you for supporting BHIC.</p>",text:"Dear {{ name }},\n\nThank you for supporting BHIC."}}),b=(0,a.useMemo)(()=>"existing"===g.templateMode?e.templates.find(e=>e.id===g.templateId):g.newTemplate,[e.templates,g.templateId,g.templateMode,g.newTemplate]);function f(e,t){j(a=>({...a,audience:{...a.audience,[e]:t}}))}function v(e,t){j(a=>({...a,newTemplate:{...a.newTemplate,[e]:t}}))}return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("ol",{className:"flex flex-wrap items-center gap-4 text-sm font-medium text-slate-500",children:["Campaign","Audience","Template","Review"].map((e,a)=>(0,t.jsxs)("li",{className:a===c?"text-brand":void 0,children:[a+1,". ",e]},e))}),0===c?(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Campaign name"}),(0,t.jsx)(n.Input,{value:g.name,onChange:e=>j(t=>({...t,name:e.target.value}))})]}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Use a descriptive name that is easy for staff to identify later."})]}):null,1===c?(0,t.jsxs)("section",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Donated within (days)"}),(0,t.jsx)(n.Input,{type:"number",min:0,value:g.audience.donatedWithinDays,onChange:e=>f("donatedWithinDays",Number(e.target.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Minimum lifetime value ($)"}),(0,t.jsx)(n.Input,{type:"number",min:0,value:g.audience.totalGivenGreaterThan,onChange:e=>f("totalGivenGreaterThan",Number(e.target.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Attended events"}),(0,t.jsx)("select",{multiple:!0,className:"h-32 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",value:g.audience.attendedEventIds,onChange:e=>f("attendedEventIds",Array.from(e.target.selectedOptions,e=>e.value)),children:e.events.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," Â· ",function(e,t={month:"short",day:"numeric",year:"numeric"}){let a="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("en-US",t).format(a)}(e.startDate)]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Pledge campaigns"}),(0,t.jsx)("select",{multiple:!0,className:"h-32 w-full rounded-xl border border-slate-200 px-3 py-2 text-sm",value:g.audience.pledgeCampaigns,onChange:e=>f("pledgeCampaigns",Array.from(e.target.selectedOptions,e=>e.value)),children:e.pledgeCampaigns.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]}):null,2===c?(0,t.jsxs)("section",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-700",children:"Template source"}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-4",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"radio",name:"templateMode",value:"existing",checked:"existing"===g.templateMode,onChange:()=>j(e=>({...e,templateMode:"existing"})),disabled:!e.templates.length}),"Use existing template"]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"radio",name:"templateMode",value:"new",checked:"new"===g.templateMode,onChange:()=>j(e=>({...e,templateMode:"new"}))}),"Create new template"]})]})]}),"existing"===g.templateMode?(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Select template"}),(0,t.jsx)(i,{value:g.templateId,onChange:e=>j(t=>({...t,templateId:e.target.value})),children:e.templates.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))})]}):(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Template name"}),(0,t.jsx)(n.Input,{value:g.newTemplate.name,onChange:e=>v("name",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Subject"}),(0,t.jsx)(n.Input,{value:g.newTemplate.subject,onChange:e=>v("subject",e.target.value)})]}),(0,t.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"HTML body"}),(0,t.jsx)(d,{rows:4,value:g.newTemplate.html,onChange:e=>v("html",e.target.value)})]}),(0,t.jsxs)("div",{className:"md:col-span-2 space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-slate-700",children:"Text body"}),(0,t.jsx)(d,{rows:4,value:g.newTemplate.text,onChange:e=>v("text",e.target.value)})]})]})]}):null,3===c?(0,t.jsx)("section",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-700",children:"Preview"}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["Gemini will use this template plus donor context to suggest a final draft after you save. Below is the base content rendered for"," ",e.sampleDonor?.name??"a sample donor","."]}),(0,t.jsxs)("div",{className:"mt-3 rounded-2xl bg-white p-4 shadow-inner",children:[(0,t.jsx)("div",{className:"font-semibold text-slate-900",children:b?.subject??"Subject TBD"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-slate-700",dangerouslySetInnerHTML:{__html:(r=b?.html,m=e.sampleDonor?.name??"BHIC Supporter",r?.replace(/{{\s*name\s*}}/gi,m)??"")}})]})]})}):null,p.error?(0,t.jsx)("p",{className:"text-sm text-red-500",children:p.error}):null,p.success?(0,t.jsx)("p",{className:"text-sm text-green-600",children:p.success}):null,(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(s.Button,{type:"button",variant:"ghost",onClick:function(){o(e=>{let t=e-1;return t<0?0:t})},disabled:0===c,children:"Back"}),c<3?(0,t.jsx)(s.Button,{type:"button",onClick:function(){o(e=>{let t=e+1;return t>3?3:t})},children:"Next"}):(0,t.jsx)(s.Button,{type:"button",onClick:function(){h({}),u(async()=>{try{let e={name:g.name,audience:{donatedWithinDays:g.audience.donatedWithinDays,totalGivenGreaterThan:g.audience.totalGivenGreaterThan,attendedEventIds:g.audience.attendedEventIds,pledgeCampaigns:g.audience.pledgeCampaigns},template:"existing"===g.templateMode?{mode:"existing",templateId:g.templateId}:{mode:"new",name:g.newTemplate.name,subject:g.newTemplate.subject,html:g.newTemplate.html,text:g.newTemplate.text}};(await l(e)).success&&h({success:"Campaign saved successfully."})}catch(e){h({error:e instanceof Error?e.message:"Unable to create campaign."})}})},disabled:x,children:x?"Saving...":"Save campaign"})]})]})}e.s(["CampaignWizard",()=>r],19608)}]);