{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/src/lib/email.ts"],"sourcesContent":["import { GoogleGenerativeAI } from '@google/generative-ai';\r\nimport type { Prisma } from '@prisma/client';\r\nimport { subDays } from 'date-fns';\r\n\r\nimport { env } from '@/lib/env';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport interface AudienceFilters {\r\n  donatedWithinDays?: number;\r\n  totalGivenGreaterThan?: number;\r\n  attendedEventIds?: string[];\r\n  pledgeCampaigns?: string[];\r\n}\r\n\r\nexport interface EmailDraftSuggestion {\r\n  subject: string;\r\n  html: string;\r\n  text: string;\r\n  talkingPoints: string[];\r\n  sampleRecipients: string[];\r\n}\r\n\r\nconst genAI = new GoogleGenerativeAI(env.GEMINI_API_KEY);\r\nconst geminiModel = genAI.getGenerativeModel({ model: env.GEMINI_MODEL });\r\n\r\nfunction renderContent(content: string, donorName?: string | null) {\r\n  if (!content) return content;\r\n  return content.replace(/{{\\s*name\\s*}}/gi, donorName ?? 'BHIC supporter');\r\n}\r\n\r\nfunction stripHtml(html: string) {\r\n  return html.replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\r\n}\r\n\r\nfunction buildPrompt(options: {\r\n  campaignName: string;\r\n  templateSubject: string;\r\n  templateHtml: string;\r\n  templateText: string;\r\n  donorSummary: string;\r\n  goals?: string;\r\n}) {\r\n  return `\r\nYou are an assistant helping the Bald Head Island Conservancy craft donor outreach emails.\r\nWrite with a warm, professional tone that reflects a conservation nonprofit.\r\n\r\nReturn ONLY valid JSON with the following shape:\r\n{\r\n  \"subject\": string,\r\n  \"html\": string,\r\n  \"text\": string,\r\n  \"talkingPoints\": string[]\r\n}\r\n\r\nGuidance:\r\n- Keep the subject under 80 characters.\r\n- Provide a short HTML body (2-4 paragraphs max) with basic formatting (p, strong, ul/li).\r\n- Provide a text-only alternative that mirrors the HTML content.\r\n- talkingPoints should be a short array summarizing the main ideas.\r\n\r\nContext:\r\n- Campaign: ${options.campaignName}\r\n- Existing subject: ${options.templateSubject}\r\n- Existing HTML (converted to text): ${stripHtml(options.templateHtml).slice(0, 1200)}\r\n- Existing text: ${options.templateText.slice(0, 1200)}\r\n- Donor insights: ${options.donorSummary}\r\n- Goals or notes: ${options.goals ?? 'Highlight impact, gratitude, and a clear call to action.'}\r\n`;\r\n}\r\n\r\nfunction extractJsonPayload(output?: string) {\r\n  if (!output) {\r\n    throw new Error('Gemini did not return any text.');\r\n  }\r\n\r\n  const fenced = output.match(/```json([\\s\\S]*?)```/i);\r\n  const raw = fenced ? fenced[1].trim() : output.trim();\r\n  const firstBrace = raw.indexOf('{');\r\n  const lastBrace = raw.lastIndexOf('}');\r\n  const candidate = firstBrace !== -1 && lastBrace !== -1 ? raw.slice(firstBrace, lastBrace + 1) : raw;\r\n  return JSON.parse(candidate);\r\n}\r\n\r\nfunction fallbackSuggestion(template: { subject: string; html: string; text: string }, donorName?: string | null): EmailDraftSuggestion {\r\n  const renderedHtml = renderContent(template.html, donorName);\r\n  return {\r\n    subject: renderContent(template.subject, donorName),\r\n    html: renderedHtml,\r\n    text: renderContent(template.text, donorName),\r\n    talkingPoints: ['Automated fallback using saved template'],\r\n    sampleRecipients: donorName ? [donorName] : []\r\n  };\r\n}\r\n\r\nexport async function resolveAudienceSegment(filters: AudienceFilters) {\r\n  const where: Prisma.DonorWhereInput = {\r\n    email: { not: null }\r\n  };\r\n\r\n  if (filters.totalGivenGreaterThan) {\r\n    where.totalGiven = { gte: filters.totalGivenGreaterThan };\r\n  }\r\n\r\n  if (filters.donatedWithinDays) {\r\n    where.lastGiftDate = { gte: subDays(new Date(), filters.donatedWithinDays) };\r\n  }\r\n\r\n  if (filters.attendedEventIds?.length) {\r\n    where.attendance = {\r\n      some: {\r\n        eventId: { in: filters.attendedEventIds }\r\n      }\r\n    };\r\n  }\r\n\r\n  if (filters.pledgeCampaigns?.length) {\r\n    where.pledges = {\r\n      some: { campaign: { in: filters.pledgeCampaigns } }\r\n    };\r\n  }\r\n\r\n  const donors = await prisma.donor.findMany({\r\n    where,\r\n    select: { id: true, name: true, email: true, totalGiven: true, lastGiftDate: true }\r\n  });\r\n\r\n  return donors.filter((donor) => donor.email);\r\n}\r\n\r\nexport async function generateCampaignSuggestion(campaignId: string): Promise<EmailDraftSuggestion> {\r\n  const campaign = await prisma.emailCampaign.findUnique({\r\n    where: { id: campaignId },\r\n    include: {\r\n      template: true,\r\n      audienceSegment: true\r\n    }\r\n  });\r\n\r\n  if (!campaign) {\r\n    throw new Error('Campaign not found');\r\n  }\r\n\r\n  const filters = (campaign.audienceSegment.filters ?? {}) as AudienceFilters;\r\n  const recipients = await resolveAudienceSegment(filters);\r\n  const sampleRecipients = recipients.slice(0, 5).map((donor) => ({\r\n    name: donor.name ?? donor.email,\r\n    email: donor.email!,\r\n    totalGiven: Number(donor.totalGiven ?? 0).toFixed(0),\r\n    lastGiftDate: donor.lastGiftDate?.toISOString() ?? 'Unknown'\r\n  }));\r\n\r\n  const donorSummary =\r\n    sampleRecipients.length > 0\r\n      ? sampleRecipients\r\n          .map(\r\n            (donor) =>\r\n              `${donor.name} (${donor.email}) – lifetime $${donor.totalGiven} · last gift ${donor.lastGiftDate.slice(0, 10)}`\r\n          )\r\n          .join('; ')\r\n      : 'No matching donors found yet. Suggest a general-purpose draft.';\r\n\r\n  try {\r\n    const prompt = buildPrompt({\r\n      campaignName: campaign.name,\r\n      templateSubject: campaign.template.subject,\r\n      templateHtml: campaign.template.html,\r\n      templateText: campaign.template.text,\r\n      donorSummary\r\n    });\r\n\r\n    const response = await geminiModel.generateContent(prompt);\r\n    const suggestion = extractJsonPayload(response.response?.text());\r\n\r\n    return {\r\n      subject: suggestion.subject ?? campaign.template.subject,\r\n      html: suggestion.html ?? campaign.template.html,\r\n      text: suggestion.text ?? campaign.template.text,\r\n      talkingPoints: suggestion.talkingPoints ?? [],\r\n      sampleRecipients: sampleRecipients.map((recipient) => recipient.email)\r\n    };\r\n  } catch (error) {\r\n    console.error('Gemini draft generation failed', error);\r\n    const donorName = sampleRecipients[0]?.name;\r\n    return fallbackSuggestion(campaign.template, donorName);\r\n  }\r\n}\r\n\r\nexport async function generateThankYouSuggestion(donorId: string): Promise<EmailDraftSuggestion> {\r\n  const donor = await prisma.donor.findUnique({\r\n    where: { id: donorId },\r\n    select: { name: true, email: true, totalGiven: true, lastGiftDate: true }\r\n  });\r\n\r\n  if (!donor) {\r\n    throw new Error('Donor not found');\r\n  }\r\n\r\n  const template = await prisma.emailTemplate.findFirst({ where: { isDefaultThankYou: true } });\r\n  if (!template) {\r\n    throw new Error('Default thank-you template is missing.');\r\n  }\r\n\r\n  const prompt = buildPrompt({\r\n    campaignName: 'Personal thank-you message',\r\n    templateSubject: template.subject,\r\n    templateHtml: template.html,\r\n    templateText: template.text,\r\n    donorSummary: `Recipient ${donor.name ?? donor.email} donated a lifetime total of $${Number(donor.totalGiven ?? 0).toFixed(\r\n      0\r\n    )}. Last gift date: ${donor.lastGiftDate ?? 'unknown'}.`\r\n  });\r\n\r\n  try {\r\n    const response = await geminiModel.generateContent(prompt);\r\n    const suggestion = extractJsonPayload(response.response?.text());\r\n    return {\r\n      subject: suggestion.subject ?? renderContent(template.subject, donor.name),\r\n      html: suggestion.html ?? renderContent(template.html, donor.name),\r\n      text: suggestion.text ?? renderContent(template.text, donor.name),\r\n      talkingPoints: suggestion.talkingPoints ?? []\r\n    };\r\n  } catch (error) {\r\n    console.error('Gemini thank-you draft failed', error);\r\n    return fallbackSuggestion(template, donor.name);\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/src/app/%28dashboard%29/emails/actions.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { CampaignStatus } from '@prisma/client';\r\nimport { getServerSession } from 'next-auth';\r\nimport { z } from 'zod';\r\n\r\nimport { authOptions } from '@/lib/auth';\r\nimport { AudienceFilters, generateCampaignSuggestion } from '@/lib/email';\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nconst createCampaignSchema = z.object({\r\n  name: z.string().min(3),\r\n  audience: z.object({\r\n    donatedWithinDays: z.number().optional(),\r\n    totalGivenGreaterThan: z.number().optional(),\r\n    attendedEventIds: z.array(z.string()).optional(),\r\n    pledgeCampaigns: z.array(z.string()).optional()\r\n  }),\r\n  template: z.discriminatedUnion('mode', [\r\n    z.object({\r\n      mode: z.literal('existing'),\r\n      templateId: z.string().min(1)\r\n    }),\r\n    z.object({\r\n      mode: z.literal('new'),\r\n      name: z.string().min(3),\r\n      subject: z.string().min(3),\r\n      html: z.string().min(10),\r\n      text: z.string().min(10)\r\n    })\r\n  ])\r\n});\r\n\r\nexport type CreateCampaignInput = z.infer<typeof createCampaignSchema>;\r\n\r\nasync function requireSession() {\r\n  const session = await getServerSession(authOptions);\r\n  if (!session) {\r\n    throw new Error('Authentication required');\r\n  }\r\n  return session;\r\n}\r\n\r\nexport async function createCampaignAction(data: CreateCampaignInput) {\r\n  await requireSession();\r\n  const parsed = createCampaignSchema.parse(data);\r\n\r\n  const filters: AudienceFilters = {\r\n    donatedWithinDays: parsed.audience.donatedWithinDays,\r\n    totalGivenGreaterThan: parsed.audience.totalGivenGreaterThan,\r\n    attendedEventIds: parsed.audience.attendedEventIds?.filter(Boolean),\r\n    pledgeCampaigns: parsed.audience.pledgeCampaigns?.filter(Boolean)\r\n  };\r\n\r\n  const segment = await prisma.audienceSegment.create({\r\n    data: {\r\n      name: `${parsed.name} audience ${Date.now()}`,\r\n      filters\r\n    }\r\n  });\r\n\r\n  let templateId: string;\r\n  if (parsed.template.mode === 'existing') {\r\n    templateId = parsed.template.templateId;\r\n  } else {\r\n    const template = await prisma.emailTemplate.create({\r\n      data: {\r\n        name: parsed.template.name,\r\n        subject: parsed.template.subject,\r\n        html: parsed.template.html,\r\n        text: parsed.template.text\r\n      }\r\n    });\r\n    templateId = template.id;\r\n  }\r\n\r\n  const campaign = await prisma.emailCampaign.create({\r\n    data: {\r\n      name: parsed.name,\r\n      templateId,\r\n      audienceSegmentId: segment.id,\r\n      status: CampaignStatus.DRAFT,\r\n      scheduledFor: null\r\n    }\r\n  });\r\n\r\n  return { success: true, campaignId: campaign.id };\r\n}\r\n\r\nexport async function generateCampaignDraftAction(campaignId: string) {\r\n  await requireSession();\r\n  const suggestion = await generateCampaignSuggestion(campaignId);\r\n  return { success: true, suggestion };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAEA;AACA;AACA;;;;;;;;;AAEA,MAAM,uBAAuB,kLAAC,CAAC,MAAM,CAAC;IACpC,MAAM,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;IACrB,UAAU,kLAAC,CAAC,MAAM,CAAC;QACjB,mBAAmB,kLAAC,CAAC,MAAM,GAAG,QAAQ;QACtC,uBAAuB,kLAAC,CAAC,MAAM,GAAG,QAAQ;QAC1C,kBAAkB,kLAAC,CAAC,KAAK,CAAC,kLAAC,CAAC,MAAM,IAAI,QAAQ;QAC9C,iBAAiB,kLAAC,CAAC,KAAK,CAAC,kLAAC,CAAC,MAAM,IAAI,QAAQ;IAC/C;IACA,UAAU,kLAAC,CAAC,kBAAkB,CAAC,QAAQ;QACrC,kLAAC,CAAC,MAAM,CAAC;YACP,MAAM,kLAAC,CAAC,OAAO,CAAC;YAChB,YAAY,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;QAC7B;QACA,kLAAC,CAAC,MAAM,CAAC;YACP,MAAM,kLAAC,CAAC,OAAO,CAAC;YAChB,MAAM,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;YACrB,SAAS,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;YACxB,MAAM,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;YACrB,MAAM,kLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;QACvB;KACD;AACH;AAIA,eAAe;IACb,MAAM,UAAU,MAAM,IAAA,yJAAgB,EAAC,iIAAW;IAClD,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,eAAe,qBAAqB,IAAyB;IAClE,MAAM;IACN,MAAM,SAAS,qBAAqB,KAAK,CAAC;IAE1C,MAAM,UAA2B;QAC/B,mBAAmB,OAAO,QAAQ,CAAC,iBAAiB;QACpD,uBAAuB,OAAO,QAAQ,CAAC,qBAAqB;QAC5D,kBAAkB,OAAO,QAAQ,CAAC,gBAAgB,EAAE,OAAO;QAC3D,iBAAiB,OAAO,QAAQ,CAAC,eAAe,EAAE,OAAO;IAC3D;IAEA,MAAM,UAAU,MAAM,8HAAM,CAAC,eAAe,CAAC,MAAM,CAAC;QAClD,MAAM;YACJ,MAAM,GAAG,OAAO,IAAI,CAAC,UAAU,EAAE,KAAK,GAAG,IAAI;YAC7C;QACF;IACF;IAEA,IAAI;IACJ,IAAI,OAAO,QAAQ,CAAC,IAAI,KAAK,YAAY;QACvC,aAAa,OAAO,QAAQ,CAAC,UAAU;IACzC,OAAO;QACL,MAAM,WAAW,MAAM,8HAAM,CAAC,aAAa,CAAC,MAAM,CAAC;YACjD,MAAM;gBACJ,MAAM,OAAO,QAAQ,CAAC,IAAI;gBAC1B,SAAS,OAAO,QAAQ,CAAC,OAAO;gBAChC,MAAM,OAAO,QAAQ,CAAC,IAAI;gBAC1B,MAAM,OAAO,QAAQ,CAAC,IAAI;YAC5B;QACF;QACA,aAAa,SAAS,EAAE;IAC1B;IAEA,MAAM,WAAW,MAAM,8HAAM,CAAC,aAAa,CAAC,MAAM,CAAC;QACjD,MAAM;YACJ,MAAM,OAAO,IAAI;YACjB;YACA,mBAAmB,QAAQ,EAAE;YAC7B,QAAQ,+IAAc,CAAC,KAAK;YAC5B,cAAc;QAChB;IACF;IAEA,OAAO;QAAE,SAAS;QAAM,YAAY,SAAS,EAAE;IAAC;AAClD;AAEO,eAAe,4BAA4B,UAAkB;IAClE,MAAM;IACN,MAAM,aAAa,MAAM,IAAA,iJAA0B,EAAC;IACpD,OAAO;QAAE,SAAS;QAAM;IAAW;AACrC;;;IAlDsB;IA8CA;;AA9CA,+OAAA;AA8CA,+OAAA"}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/.next-internal/server/app/%28dashboard%29/emails/create/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {generateCampaignDraftAction as '40846960b200b916f9a40813d0a8308bb44529a1d7'} from 'ACTIONS_MODULE0'\nexport {createCampaignAction as '40c811d9f42c649217d4e5353739aa7c02b2497bc4'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 355, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n"],"names":["registerServerReference"],"mappings":"AAAA,oDAAoD;;;+BAC3CA,2BAAAA;;;eAAAA,QAAAA,uBAAuB;;;wBAAQ","ignoreList":[0]}},
    {"offset": {"line": 369, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@google/generative-ai/dist/index.mjs","sources":[],"sourcesContent":[],"names":[],"mappings":""}},
    {"offset": {"line": 1656, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/date-fns/constants.js"],"sourcesContent":["/**\n * @module constants\n * @summary Useful constants\n * @description\n * Collection of useful date constants.\n *\n * The constants could be imported from `date-fns/constants`:\n *\n * ```ts\n * import { maxTime, minTime } from \"./constants/date-fns/constants\";\n *\n * function isAllowedTime(time) {\n *   return time <= maxTime && time >= minTime;\n * }\n * ```\n */\n\n/**\n * @constant\n * @name daysInWeek\n * @summary Days in 1 week.\n */\nexport const daysInWeek = 7;\n\n/**\n * @constant\n * @name daysInYear\n * @summary Days in 1 year.\n *\n * @description\n * How many days in a year.\n *\n * One years equals 365.2425 days according to the formula:\n *\n * > Leap year occurs every 4 years, except for years that are divisible by 100 and not divisible by 400.\n * > 1 mean year = (365+1/4-1/100+1/400) days = 365.2425 days\n */\nexport const daysInYear = 365.2425;\n\n/**\n * @constant\n * @name maxTime\n * @summary Maximum allowed time.\n *\n * @example\n * import { maxTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = 8640000000000001 <= maxTime;\n * //=> false\n *\n * new Date(8640000000000001);\n * //=> Invalid Date\n */\nexport const maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1000;\n\n/**\n * @constant\n * @name minTime\n * @summary Minimum allowed time.\n *\n * @example\n * import { minTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = -8640000000000001 >= minTime;\n * //=> false\n *\n * new Date(-8640000000000001)\n * //=> Invalid Date\n */\nexport const minTime = -maxTime;\n\n/**\n * @constant\n * @name millisecondsInWeek\n * @summary Milliseconds in 1 week.\n */\nexport const millisecondsInWeek = 604800000;\n\n/**\n * @constant\n * @name millisecondsInDay\n * @summary Milliseconds in 1 day.\n */\nexport const millisecondsInDay = 86400000;\n\n/**\n * @constant\n * @name millisecondsInMinute\n * @summary Milliseconds in 1 minute\n */\nexport const millisecondsInMinute = 60000;\n\n/**\n * @constant\n * @name millisecondsInHour\n * @summary Milliseconds in 1 hour\n */\nexport const millisecondsInHour = 3600000;\n\n/**\n * @constant\n * @name millisecondsInSecond\n * @summary Milliseconds in 1 second\n */\nexport const millisecondsInSecond = 1000;\n\n/**\n * @constant\n * @name minutesInYear\n * @summary Minutes in 1 year.\n */\nexport const minutesInYear = 525600;\n\n/**\n * @constant\n * @name minutesInMonth\n * @summary Minutes in 1 month.\n */\nexport const minutesInMonth = 43200;\n\n/**\n * @constant\n * @name minutesInDay\n * @summary Minutes in 1 day.\n */\nexport const minutesInDay = 1440;\n\n/**\n * @constant\n * @name minutesInHour\n * @summary Minutes in 1 hour.\n */\nexport const minutesInHour = 60;\n\n/**\n * @constant\n * @name monthsInQuarter\n * @summary Months in 1 quarter.\n */\nexport const monthsInQuarter = 3;\n\n/**\n * @constant\n * @name monthsInYear\n * @summary Months in 1 year.\n */\nexport const monthsInYear = 12;\n\n/**\n * @constant\n * @name quartersInYear\n * @summary Quarters in 1 year\n */\nexport const quartersInYear = 4;\n\n/**\n * @constant\n * @name secondsInHour\n * @summary Seconds in 1 hour.\n */\nexport const secondsInHour = 3600;\n\n/**\n * @constant\n * @name secondsInMinute\n * @summary Seconds in 1 minute.\n */\nexport const secondsInMinute = 60;\n\n/**\n * @constant\n * @name secondsInDay\n * @summary Seconds in 1 day.\n */\nexport const secondsInDay = secondsInHour * 24;\n\n/**\n * @constant\n * @name secondsInWeek\n * @summary Seconds in 1 week.\n */\nexport const secondsInWeek = secondsInDay * 7;\n\n/**\n * @constant\n * @name secondsInYear\n * @summary Seconds in 1 year.\n */\nexport const secondsInYear = secondsInDay * daysInYear;\n\n/**\n * @constant\n * @name secondsInMonth\n * @summary Seconds in 1 month\n */\nexport const secondsInMonth = secondsInYear / 12;\n\n/**\n * @constant\n * @name secondsInQuarter\n * @summary Seconds in 1 quarter.\n */\nexport const secondsInQuarter = secondsInMonth * 3;\n\n/**\n * @constant\n * @name constructFromSymbol\n * @summary Symbol enabling Date extensions to inherit properties from the reference date.\n *\n * The symbol is used to enable the `constructFrom` function to construct a date\n * using a reference date and a value. It allows to transfer extra properties\n * from the reference date to the new date. It's useful for extensions like\n * [`TZDate`](https://github.com/date-fns/tz) that accept a time zone as\n * a constructor argument.\n */\nexport const constructFromSymbol = Symbol.for(\"constructDateFrom\");\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;CAeC,GAED;;;;CAIC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACM,MAAM,aAAa;AAenB,MAAM,aAAa;AAgBnB,MAAM,UAAU,KAAK,GAAG,CAAC,IAAI,KAAK,KAAK,KAAK,KAAK;AAgBjD,MAAM,UAAU,CAAC;AAOjB,MAAM,qBAAqB;AAO3B,MAAM,oBAAoB;AAO1B,MAAM,uBAAuB;AAO7B,MAAM,qBAAqB;AAO3B,MAAM,uBAAuB;AAO7B,MAAM,gBAAgB;AAOtB,MAAM,iBAAiB;AAOvB,MAAM,eAAe;AAOrB,MAAM,gBAAgB;AAOtB,MAAM,kBAAkB;AAOxB,MAAM,eAAe;AAOrB,MAAM,iBAAiB;AAOvB,MAAM,gBAAgB;AAOtB,MAAM,kBAAkB;AAOxB,MAAM,eAAe,gBAAgB;AAOrC,MAAM,gBAAgB,eAAe;AAOrC,MAAM,gBAAgB,eAAe;AAOrC,MAAM,iBAAiB,gBAAgB;AAOvC,MAAM,mBAAmB,iBAAiB;AAa1C,MAAM,sBAAsB,OAAO,GAAG,CAAC","ignoreList":[0]}},
    {"offset": {"line": 1753, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/date-fns/constructFrom.js"],"sourcesContent":["import { constructFromSymbol } from \"./constants.js\";\n\n/**\n * @name constructFrom\n * @category Generic Helpers\n * @summary Constructs a date using the reference date and the value\n *\n * @description\n * The function constructs a new date using the constructor from the reference\n * date and the given value. It helps to build generic functions that accept\n * date extensions.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * Starting from v3.7.0, it allows to construct a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The reference date to take constructor from\n * @param value - The value to create the date\n *\n * @returns Date initialized using the given date and value\n *\n * @example\n * import { constructFrom } from \"./constructFrom/date-fns\";\n *\n * // A function that clones a date preserving the original type\n * function cloneDate<DateType extends Date>(date: DateType): DateType {\n *   return constructFrom(\n *     date, // Use constructor from the given date\n *     date.getTime() // Use the date value to create a new date\n *   );\n * }\n */\nexport function constructFrom(date, value) {\n  if (typeof date === \"function\") return date(value);\n\n  if (date && typeof date === \"object\" && constructFromSymbol in date)\n    return date[constructFromSymbol](value);\n\n  if (date instanceof Date) return new date.constructor(value);\n\n  return new Date(value);\n}\n\n// Fallback for modularized imports:\nexport default constructFrom;\n"],"names":[],"mappings":";;;;;;AAAA;;AAqCO,SAAS,cAAc,IAAI,EAAE,KAAK;IACvC,IAAI,OAAO,SAAS,YAAY,OAAO,KAAK;IAE5C,IAAI,QAAQ,OAAO,SAAS,YAAY,+JAAmB,IAAI,MAC7D,OAAO,IAAI,CAAC,+JAAmB,CAAC,CAAC;IAEnC,IAAI,gBAAgB,MAAM,OAAO,IAAI,KAAK,WAAW,CAAC;IAEtD,OAAO,IAAI,KAAK;AAClB;uCAGe","ignoreList":[0]}},
    {"offset": {"line": 1772, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/date-fns/toDate.js"],"sourcesContent":["import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * Starting from v3.7.0, it clones a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport function toDate(argument, context) {\n  // [TODO] Get rid of `toDate` or `constructFrom`?\n  return constructFrom(context || argument, argument);\n}\n\n// Fallback for modularized imports:\nexport default toDate;\n"],"names":[],"mappings":";;;;;;AAAA;;AAwCO,SAAS,OAAO,QAAQ,EAAE,OAAO;IACtC,iDAAiD;IACjD,OAAO,IAAA,6JAAa,EAAC,WAAW,UAAU;AAC5C;uCAGe","ignoreList":[0]}},
    {"offset": {"line": 1789, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/date-fns/addDays.js"],"sourcesContent":["import { constructFrom } from \"./constructFrom.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link addDays} function options.\n */\n\n/**\n * @name addDays\n * @category Day Helpers\n * @summary Add the specified number of days to the given date.\n *\n * @description\n * Add the specified number of days to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param amount - The amount of days to be added.\n * @param options - An object with options\n *\n * @returns The new date with the days added\n *\n * @example\n * // Add 10 days to 1 September 2014:\n * const result = addDays(new Date(2014, 8, 1), 10)\n * //=> Thu Sep 11 2014 00:00:00\n */\nexport function addDays(date, amount, options) {\n  const _date = toDate(date, options?.in);\n  if (isNaN(amount)) return constructFrom(options?.in || date, NaN);\n\n  // If 0 days, no-op to avoid changing times in the hour before end of DST\n  if (!amount) return _date;\n\n  _date.setDate(_date.getDate() + amount);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default addDays;\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AA4BO,SAAS,QAAQ,IAAI,EAAE,MAAM,EAAE,OAAO;IAC3C,MAAM,QAAQ,IAAA,+IAAM,EAAC,MAAM,SAAS;IACpC,IAAI,MAAM,SAAS,OAAO,IAAA,6JAAa,EAAC,SAAS,MAAM,MAAM;IAE7D,yEAAyE;IACzE,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,OAAO,CAAC,MAAM,OAAO,KAAK;IAChC,OAAO;AACT;uCAGe","ignoreList":[0]}},
    {"offset": {"line": 1812, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/date-fns/subDays.js"],"sourcesContent":["import { addDays } from \"./addDays.js\";\n\n/**\n * The {@link subDays} function options.\n */\n\n/**\n * @name subDays\n * @category Day Helpers\n * @summary Subtract the specified number of days from the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param amount - The amount of days to be subtracted.\n * @param options - An object with options\n *\n * @returns The new date with the days subtracted\n *\n * @example\n * // Subtract 10 days from 1 September 2014:\n * const result = subDays(new Date(2014, 8, 1), 10)\n * //=> Fri Aug 22 2014 00:00:00\n */\nexport function subDays(date, amount, options) {\n  return addDays(date, -amount, options);\n}\n\n// Fallback for modularized imports:\nexport default subDays;\n"],"names":[],"mappings":";;;;;;AAAA;;AAyBO,SAAS,QAAQ,IAAI,EAAE,MAAM,EAAE,OAAO;IAC3C,OAAO,IAAA,iJAAO,EAAC,MAAM,CAAC,QAAQ;AAChC;uCAGe","ignoreList":[0]}},
    {"offset": {"line": 1828, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts"],"sourcesContent":["// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n"],"names":["ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"AAAA,+EAA+E;AAC/E,yEAAyE;AACzE,iEAAiE;;;;+BACjDA,4BAAAA;;;eAAAA;;;AAAT,SAASA,yBAAyBC,OAAc;IACrD,IAAK,IAAIC,IAAI,GAAGA,IAAID,QAAQE,MAAM,EAAED,IAAK;QACvC,MAAME,SAASH,OAAO,CAACC,EAAE;QACzB,IAAI,OAAOE,WAAW,YAAY;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,OAAO,uEAAuE,CAAC,GADhJ,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;IACF;AACF","ignoreList":[0]}}]
}