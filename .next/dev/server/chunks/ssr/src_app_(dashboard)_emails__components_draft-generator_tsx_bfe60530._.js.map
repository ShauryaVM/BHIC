{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Shaurya/Documents/GitHub/BHIC/src/app/%28dashboard%29/emails/_components/draft-generator.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { ReactNode } from 'react';\r\nimport { useMemo, useState, useTransition } from 'react';\r\n\r\nimport type { EmailDraftSuggestion } from '@/lib/email';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ninterface DraftGeneratorProps {\r\n  campaignId: string;\r\n  action: (campaignId: string) => Promise<{ success: boolean; suggestion: EmailDraftSuggestion }>;\r\n}\r\n\r\nexport function DraftGenerator({ campaignId, action }: DraftGeneratorProps) {\r\n  const [pending, startTransition] = useTransition();\r\n  const [draft, setDraft] = useState<EmailDraftSuggestion | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  function handleGenerate() {\r\n    setError(null);\r\n    startTransition(async () => {\r\n      try {\r\n        const result = await action(campaignId);\r\n        if (result.success) {\r\n          setDraft(result.suggestion);\r\n        }\r\n      } catch (err) {\r\n        setError(err instanceof Error ? err.message : 'Unable to generate suggestion.');\r\n      }\r\n    });\r\n  }\r\n\r\n  const previewHtml = useMemo(() => ({ __html: draft?.html ?? '' }), [draft]);\r\n\r\n  return (\r\n    <div className=\"w-full space-y-3 rounded-2xl border border-slate-200 bg-slate-50 p-4\">\r\n      <div className=\"flex items-center justify-between gap-3\">\r\n        <div>\r\n          <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">AI suggestion</p>\r\n          <p className=\"text-[11px] text-slate-500\">Review before sending. Nothing is emailed automatically.</p>\r\n        </div>\r\n        <Button type=\"button\" variant=\"secondary\" size=\"sm\" disabled={pending} onClick={handleGenerate}>\r\n          {pending ? 'Generating...' : draft ? 'Refresh draft' : 'Generate draft'}\r\n        </Button>\r\n      </div>\r\n      {error ? <p className=\"text-sm text-red-500\">{error}</p> : null}\r\n      {draft ? (\r\n        <div className=\"space-y-4 rounded-2xl border border-white/60 bg-white p-4 shadow-inner\">\r\n          <section>\r\n            <HeaderRow label=\"Suggested subject\">\r\n              <CopyButton value={draft.subject} />\r\n            </HeaderRow>\r\n            <p className=\"text-sm font-semibold text-slate-900\">{draft.subject}</p>\r\n          </section>\r\n          <section>\r\n            <HeaderRow label=\"HTML preview\">\r\n              <CopyButton value={draft.html} />\r\n            </HeaderRow>\r\n            <div className=\"prose prose-sm max-w-none text-slate-700\" dangerouslySetInnerHTML={previewHtml} />\r\n          </section>\r\n          <section>\r\n            <HeaderRow label=\"Plain text\">\r\n              <CopyButton value={draft.text} />\r\n            </HeaderRow>\r\n            <pre className=\"max-h-48 overflow-auto whitespace-pre-wrap rounded-xl bg-slate-50 p-3 text-xs text-slate-700\">\r\n              {draft.text}\r\n            </pre>\r\n          </section>\r\n          {draft.talkingPoints?.length ? (\r\n            <section>\r\n              <p className=\"text-xs font-semibold uppercase tracking-wider text-slate-500\">Talking points</p>\r\n              <ul className=\"list-disc space-y-1 pl-4 text-sm text-slate-700\">\r\n                {draft.talkingPoints.map((point) => (\r\n                  <li key={point}>{point}</li>\r\n                ))}\r\n              </ul>\r\n            </section>\r\n          ) : null}\r\n        </div>\r\n      ) : (\r\n        <p className=\"text-sm text-slate-500\">Generate a tailored subject and body using Gemini, then copy into your email platform.</p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction HeaderRow({ label, children }: { label: string; children?: ReactNode }) {\r\n  return (\r\n    <div className=\"mb-1 flex items-center justify-between text-xs text-slate-500\">\r\n      <span className=\"font-semibold uppercase tracking-wider\">{label}</span>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CopyButton({ value }: { value: string }) {\r\n  const [copied, setCopied] = useState(false);\r\n\r\n  async function copy() {\r\n    try {\r\n      await navigator.clipboard.writeText(value);\r\n      setCopied(true);\r\n      setTimeout(() => setCopied(false), 2000);\r\n    } catch {\r\n      setCopied(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <button\r\n      type=\"button\"\r\n      onClick={copy}\r\n      className=\"rounded-full border border-slate-200 px-3 py-1 text-[11px] font-semibold uppercase tracking-wide text-slate-600 transition hover:border-slate-300\"\r\n    >\r\n      {copied ? 'Copied' : 'Copy'}\r\n    </button>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAGA;AAGA;AANA;;;;AAaO,SAAS,eAAe,EAAE,UAAU,EAAE,MAAM,EAAuB;IACxE,MAAM,CAAC,SAAS,gBAAgB,GAAG,IAAA,sNAAa;IAChD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAA8B;IAChE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,SAAS;QACP,SAAS;QACT,gBAAgB;YACd,IAAI;gBACF,MAAM,SAAS,MAAM,OAAO;gBAC5B,IAAI,OAAO,OAAO,EAAE;oBAClB,SAAS,OAAO,UAAU;gBAC5B;YACF,EAAE,OAAO,KAAK;gBACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;YAChD;QACF;IACF;IAEA,MAAM,cAAc,IAAA,gNAAO,EAAC,IAAM,CAAC;YAAE,QAAQ,OAAO,QAAQ;QAAG,CAAC,GAAG;QAAC;KAAM;IAE1E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAE,WAAU;0CAAgE;;;;;;0CAC7E,8OAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAE5C,8OAAC,4IAAM;wBAAC,MAAK;wBAAS,SAAQ;wBAAY,MAAK;wBAAK,UAAU;wBAAS,SAAS;kCAC7E,UAAU,kBAAkB,QAAQ,kBAAkB;;;;;;;;;;;;YAG1D,sBAAQ,8OAAC;gBAAE,WAAU;0BAAwB;;;;;uBAAa;YAC1D,sBACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAU,OAAM;0CACf,cAAA,8OAAC;oCAAW,OAAO,MAAM,OAAO;;;;;;;;;;;0CAElC,8OAAC;gCAAE,WAAU;0CAAwC,MAAM,OAAO;;;;;;;;;;;;kCAEpE,8OAAC;;0CACC,8OAAC;gCAAU,OAAM;0CACf,cAAA,8OAAC;oCAAW,OAAO,MAAM,IAAI;;;;;;;;;;;0CAE/B,8OAAC;gCAAI,WAAU;gCAA2C,yBAAyB;;;;;;;;;;;;kCAErF,8OAAC;;0CACC,8OAAC;gCAAU,OAAM;0CACf,cAAA,8OAAC;oCAAW,OAAO,MAAM,IAAI;;;;;;;;;;;0CAE/B,8OAAC;gCAAI,WAAU;0CACZ,MAAM,IAAI;;;;;;;;;;;;oBAGd,MAAM,aAAa,EAAE,uBACpB,8OAAC;;0CACC,8OAAC;gCAAE,WAAU;0CAAgE;;;;;;0CAC7E,8OAAC;gCAAG,WAAU;0CACX,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,sBACxB,8OAAC;kDAAgB;uCAAR;;;;;;;;;;;;;;;+BAIb;;;;;;qCAGN,8OAAC;gBAAE,WAAU;0BAAyB;;;;;;;;;;;;AAI9C;AAEA,SAAS,UAAU,EAAE,KAAK,EAAE,QAAQ,EAA2C;IAC7E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAK,WAAU;0BAA0C;;;;;;YACzD;;;;;;;AAGP;AAEA,SAAS,WAAW,EAAE,KAAK,EAAqB;IAC9C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IAErC,eAAe;QACb,IAAI;YACF,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;YACpC,UAAU;YACV,WAAW,IAAM,UAAU,QAAQ;QACrC,EAAE,OAAM;YACN,UAAU;QACZ;IACF;IAEA,qBACE,8OAAC;QACC,MAAK;QACL,SAAS;QACT,WAAU;kBAET,SAAS,WAAW;;;;;;AAG3B"}}]
}